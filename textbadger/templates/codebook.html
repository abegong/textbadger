{% extends "base/document-control.html" %}
{% load tb_app_tags %}

{% block doc_classes %}
    span3
    well
    offset3
{% endblock %}

{% block start_scripts %}
<script src="{{ STATIC_URL }}jquery.tmpl.min.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}underscore-min.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}knockout-1.2.1.js" type="text/javascript"></script>

<script src="{{ STATIC_URL }}informal/informalEditor.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}informal/informalModel.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}informal/informalScripts.js" type="text/javascript"></script>

<script type="text/javascript">
J = [{
    "question_type" : "Radio matrix",
    "var_name" : "default_question",
    "params" : {
        "header_text" : "<h2> Entertainment </h2>",
        "answer_array" : ["sA","A","N","D","sD"],
        "question_array" : ["The article is intentionally humorous","The author uses gimmicks in an attempt to gain attention","The author uses satire: saying something when you mean the opposite","The article poses rhetorical questions","Politics is presented as a game","The article draws attention to the faults of an organization or individual","There are aspects of sensationalism","The main goal of this article is to entertain the reader","The article has a high level of newsworthiness","The author pokes fun of an issue or person in a humorous way","The author attempts to interject humor into a news story"]
    }
},
{
    "question_type" : "Multiple choice",
    "var_name" : "default_question",
    "params" : {
        "header_text" : "Does the author use any of the following: irony, satire, sarcasm or puns?",
        "answer_array" : ["Yes","No"],
        "question_array" : ["The article is intentionally humorous","The author uses gimmicks in an attempt to gain attention","The author uses satire: saying something when you mean the opposite","The article poses rhetorical questions","Politics is presented as a game","The article draws attention to the faults of an organization or individual","There are aspects of sensationalism","The main goal of this article is to entertain the reader","The article has a high level of newsworthiness","The author pokes fun of an issue or person in a humorous way","The author attempts to interject humor into a news story"],
        "left_statements" : ["Statement 1","Statement 2"],
        "right_statements" : ["Statement 1","Statement 2"],
        "cols" : 20
    }
},
{
    "question_type" : "Two-way matrix",
    "var_name" : "default_question",
    "params" : {
        "header_text" : "",
        "answer_array" : ["1","2","3","4","6","7"],
        "question_array" : ["The article is intentionally humorous","The author uses gimmicks in an attempt to gain attention","The author uses satire: saying something when you mean the opposite","The article poses rhetorical questions","Politics is presented as a game","The article draws attention to the faults of an organization or individual","There are aspects of sensationalism","The main goal of this article is to entertain the reader","The article has a high level of newsworthiness","The author pokes fun of an issue or person in a humorous way","The author attempts to interject humor into a news story"],
        "left_statements" : ["The article was entertaining","The article was informational"],
        "right_statements" : ["The article was not entertaining","The article was not informational"],
        "cols" : 20,
        "left_statement" : "Left statement",
        "right_statement" : "Right statement"
    }
}];

function temp_load(json){
	$.get("{{ STATIC_URL }}informal/_informalTemplateKO.htm", function(template){
//        codebookModel.questions.push( new cbQuestion("Static text", "tester", {}) );
//        codebookModel.questions.push( new cbQuestion("Multiple choice", "tester", {}) );

/*	    codebookModel.questions([
		    new cbQuestion("Static text", "", {"header_text":"<h3>Static text</h3>"} ),
		    new cbQuestion("Multiple choice", "", {} ),
		    new cbQuestion("Check all that apply", "", {} ),
		    new cbQuestion("Two-way scale", "", {} ),
		    new cbQuestion("Radio matrix", "", {} ),
		    new cbQuestion("Checkbox matrix", "", {} ),
		    new cbQuestion("Two-way matrix", "", {} ),
		    new cbQuestion("Text box", "", {} ),
		    new cbQuestion("Short essay", "", {} ),
		    new cbQuestion("Text matrix", "", {} )
	    ]);
*/
//        json = initial_codebook_model
		for( q in json ){ 
			codebookModel.questions.push( new cbQuestion(json[q].question_type, json[q].var_name, json[q].params) );
		}
        console.log(codebookModel);

		$("#doc-box").append(template);
		ko.applyBindings(codebookModel);
        console.log(codebookModel);
//		attachControlsToQuestion(0);
//		$("#controlAccordion").accordion({ event: "mouseover", autoHeight:true });
		//Hack to resize accordion dynamically http://jqueryui.com/demos/accordion/#option-autoHeight
//		var autoHeight = $("#controlAccordion").accordion( "option", "autoHeight" );
//        $("#controlAccordion").accordion( "option", "autoHeight", false );
	}, "text");

}

$(function(){
    temp_load(J);
});
</script>
{% endblock %}

{% block title %}
<h3>{{codebook.name}}</h3>
{% endblock %}

{% block document %}
<!-- --- Codebook --- -->
<div data-bind="template: { name: 'question-template', foreach: questions }"></div>
{% endblock %}

{% block control %}
<div class="tabbable">
  <ul class="nav nav-tabs">
    <li class="active"><a href="#tab1" data-toggle="tab">Codebook</a></li>
    <li><a href="#tab2" data-toggle="tab">Question</a></li>
  </ul>
  <div class="tab-content">
    <div class="tab-pane active" id="tab1">
      <strong>Name</strong>
      <p>{{ codebook.name }}</p>

      <strong>Description</strong>
      <p>{{ codebook.description }}</p>

      <hr/>
      {{codebook.questions}}
      
      <div id="impexpControls">
          <a class="btn" id="exportJsonButton">Export Json</a>
          <a class="btn" id="exportSelfCButton">Export HTML</a>
<!--          <a class="btn" id="loadJsonButton">Import json</a> -->
      </div>
    </div>
    <div class="tab-pane" id="tab2">
        <dl id="meta-data" class="dl-horizontal"></ul>
        <div id="sequenceControls" style="text-align:center">
            <button id="add_control"><span class="control icon-plus"></span></button>
            <button id="del_control"><span class="control icon-minus"></span></button>
            <button id="up_control"><span class="control icon-arrow-up"></span></button>
            <button id="down_control"><span class="control icon-arrow-down"></span></button>
        </div>
        <div id="questionControls"></div>
    </div>
  </div>
</div>
{% endblock %}

