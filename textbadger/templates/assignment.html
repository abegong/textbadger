{% extends "base/document-control.html" %}
{% load tb_app_tags %}

{% block start_scripts %}
<script src="{{ STATIC_URL }}jquery.tmpl.min.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}underscore-min.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}knockout-1.2.1.js" type="text/javascript"></script>
<script src="{{ STATIC_URL }}informal/informalModel.js" type="text/javascript"></script>

<script type="text/javascript">
var launchInformalViewer = function( codebook_json ){
    codebookModel.loadQuestions(codebook_json);
    
    //Load the template and knockout model dynamically.
    $.get("/static/informal/_informalTemplateKO.htm", function(template){
        $("body").append(template);
        ko.applyBindings(codebookModel);
        codebookModel.addStylesToCodebook();
                            
		//Add the "submit" button.
		$("#codebook").append('<div class="questionBox"><div class="questionContent" style="text-align:right"><a class="btn btn-inverse">Submit</a></div></div>');

    }, "text");

};
	
	
$(function(){
    //Highlight "my-account" in nav bar
    $('a[href*="/my-account/"]').parent().addClass("active");

    DocManager.initialize("{{batch.profile.collection_id}}","{{csrf_token}}");

	$.post("/ajax/get-codebook/",
        {'id': "{{batch.profile.codebook_id}}", 'csrfmiddlewaretoken': '{{ csrf_token }}' },
        function(response){
            //! Need error checking for failed responses.
            launchInformalViewer(response.codebook.questions);       
        }
    );
});
</script>
{% endblock %}

{% block breadcrumbs %}
<div class="container">
<ul class="breadcrumb">
  <li>
    <a href="/my-account/#assignments">Assignments</a>
    <span class="divider">/</span>
  </li>
  <li>
    <a href="#">Batch 1</a></span>
  </li>
  <li>
    <span class="divider"> :: </span>
    <a href="/batch/{{ batch|mongo_id }}/">Go to batch page</a></span>
  </li>
</ul>
</div>
{% endblock %}

{% block document %}
--- Document ---
{% endblock %}

{% block control %}
<div id="codebook" data-bind="template: { name: 'question-template', foreach: questions }" tb-codebook-mode="viewer"></div>
<br/>

<!--
<div id="codebook" tb-codebook-mode="viewer"><form><fieldset>
	<div class="questionBox">
		<div class="headerText">Static text</div>
	</div>

	<div class="questionBox">
		<div class="headerText">Slider</div>
		<div class="answerSlider"></div>
	</div>


	<div class="questionBox">
		<div class="headerText">Multiple choice</div>
			<div class="answerText"><input type="radio" name="Q2" value="1">Answer 1</div>
			<div class="answerText"><input type="radio" name="Q2" value="2">Answer 2</div>
	</div>


	<div class="questionBox">
		<div class="headerText">Check all that apply</div>
		<div class="answerText"><input type="checkbox" name="Q3" value="1">Answer 1</div>
		<div class="answerText"><input type="checkbox" name="Q3" value="2">Answer 2</div>
	</div>


	<div class="questionBox">
		<div class="headerText">Two-way scale</div>
		<table class="matrixQuestion"><tbody>
			<tr>
				<td></td>
				<td>Answer 1</td>
				<td>Answer 2</td>
				<td></td>
			</tr>
			<tr>
				<td class="leftCol">Left statement</td>
				<td><input type="radio" name="Q4" value="1"></td>
				<td><input type="radio" name="Q4" value="2"></td>
				<td class="rightCol">Right statement</td>
			</tr>
		</tbody></table>
	</div>


	<div class="questionBox">
		<div class="headerText">Radio matrix</div>
		<table class="matrixQuestion">
			<thead>
				<tr>
					<td></td>
					<td>Answer 1</td>
					<td>Answer 2</td>
				</tr>
			</thead>
			<tbody>
				<tr class="even">
					<td class="textCol">Question 1</td>
					<td><input type="radio" name="Q5_1" value="1"></td>
					<td><input type="radio" name="Q5_1" value="2"></td>
				</tr>
				<tr class="odd">
					<td class="textCol">Question 2</td>
					<td><input type="radio" name="Q5_2" value="1"></td>
					<td><input type="radio" name="Q5_2" value="2"></td>
				</tr>
			</tbody>
		</table>
	</div>


	<div class="questionBox">
		<div class="headerText">Checkbox matrix</div>
		<table class="matrixQuestion">
			<thead>
				<tr>
					<td></td>
					<td>Answer 1</td>
					<td>Answer 2</td>
				</tr>
			</thead>
			<tbody>
				<tr class="even">
					<td class="textCol">Question 1</td>
					<td><input type="checkbox" name="Q6_1" value="1"></td>
					<td><input type="checkbox" name="Q6_1" value="2"></td>
				</tr>
				<tr class="odd">
					<td class="textCol">Question 2</td>
					<td><input type="checkbox" name="Q6_2" value="1"></td>
					<td><input type="checkbox" name="Q6_2" value="2"></td>
				</tr>
			</tbody>
		</table>
	</div>


	<div class="questionBox">
		<div class="headerText">Two-way matrix</div>
		<table class="matrixQuestion"><tbody>
			<tr>
				<td></td>
				<td>Answer 1</td>
				<td>Answer 2</td>
				<td></td>
			</tr>
			<tr class="even">
				<td class="leftCol">Statement 1</td>
				<td><input type="radio" name="Q7_1" value="1"></td>
				<td><input type="radio" name="Q7_1" value="2"></td>
				<td class="rightCol">Statement 1</td>
			</tr>
			<tr class="odd">
				<td class="leftCol">Statement 2</td>
				<td><input type="radio" name="Q7_2" value="1"></td>
				<td><input type="radio" name="Q7_2" value="2"></td>
				<td class="rightCol">Statement 2</td>
			</tr>
		</tbody></table>
	</div>


	<div class="questionBox">
		<div class="headerText">Text box</div>
		<input type="text" name="Q8" value="" size="20">
	</div>


	<div class="questionBox">
		<div class="headerText">Short essay</div>
		<textarea name="Q9" cols="30" rows="5"></textarea>
	</div>


	<div class="questionBox">
		<div class="headerText">Text matrix</div>
			<table class="matrixQuestion"><tbody>
				<tr class="even">
					<td class="textCol">Answer 1</td>
					<td><input type="text" name="Q10_1" size="20"/></td>
				</tr>
				<tr class="odd">
					<td class="textCol">Answer 2</td>
					<td><input type="text" name="Q10_2" size="20"/></td>
				</tr>
			</tbody></table>
		</div>
	</div>
</fieldset></form></div>
-->


{% endblock %}

